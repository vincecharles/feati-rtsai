function c(){if(typeof Chart>"u"){console.log("Waiting for Chart.js to load..."),setTimeout(c,100);return}console.log("✓ Chart.js loaded, initializing charts");const t=document.getElementById("dashboard-data");if(!t){console.error("❌ Dashboard data element not found");return}try{const d=JSON.parse(t.getAttribute("data-stats")),g=JSON.parse(t.getAttribute("data-programs")),r=JSON.parse(t.getAttribute("data-year-levels")),n=JSON.parse(t.getAttribute("data-violations")),e=JSON.parse(t.getAttribute("data-severity")||"{}"),o=JSON.parse(t.getAttribute("data-top-types")||"[]"),i=JSON.parse(t.getAttribute("data-trends")||"[]");console.log("✓ Data parsed successfully"),console.log("Severity:",e),console.log("Top Types:",o),console.log("Trends:",i),m(d,g,r,n,e,o,i)}catch(d){console.error("❌ Error parsing dashboard data:",d);return}}function m(t,d,g,r,n,e,o){console.log("Initializing all charts..."),Chart.defaults.color=document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",Chart.defaults.borderColor=document.documentElement.classList.contains("dark")?"#374151":"#E5E7EB";const i=document.getElementById("violationChart")?.getContext("2d");i&&new Chart(i,{type:"doughnut",data:{labels:["Pending","Resolved","Under Review"],datasets:[{data:[r.pending,r.resolved,r.under_review],backgroundColor:["rgb(251, 191, 36)","rgb(34, 197, 94)","rgb(59, 130, 246)"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}});const p=document.getElementById("violationTrendsChart")?.getContext("2d");if(p){console.log("Initializing Violations Analytics chart"),console.log("Trends data:",o);const l=o.length>0?o.map(a=>new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})):["No Data"],s=o.length>0?o.map(a=>a.count):[0];console.log("Trend labels:",l),console.log("Trend data:",s),new Chart(p,{type:"line",data:{labels:l,datasets:[{label:"Daily Violations",data:s,borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0,pointBackgroundColor:"rgb(239, 68, 68)",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:5,pointHoverRadius:7}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})}const u=document.getElementById("violationSeverityChart")?.getContext("2d");u&&new Chart(u,{type:"bar",data:{labels:["Minor","Moderate","Major","Critical"],datasets:[{label:"Count",data:[n.minor||0,n.moderate||0,n.major||0,n.critical||0],backgroundColor:["rgb(34, 197, 94)","rgb(251, 191, 36)","rgb(249, 115, 22)","rgb(239, 68, 68)"],borderWidth:0}]},options:{indexAxis:"x",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}});const b=document.getElementById("topViolationTypesChart")?.getContext("2d");if(b){console.log("Initializing Top Violation Types chart"),console.log("Top types data:",e);const l=e.length>0?e.map(a=>a.name):["No Data"],s=e.length>0?e.map(a=>a.count):[0];console.log("Type labels:",l),console.log("Type data:",s),new Chart(b,{type:"bar",data:{labels:l,datasets:[{label:"Reports",data:s,backgroundColor:["rgb(59, 130, 246)","rgb(139, 92, 246)","rgb(236, 72, 153)","rgb(249, 115, 22)","rgb(239, 68, 68)"].slice(0,s.length),borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}},x:{ticks:{maxRotation:45,minRotation:0}}}}})}console.log("✓ All charts initialized successfully!")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c();setTimeout(c,500);
